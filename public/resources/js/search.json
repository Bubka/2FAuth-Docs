[[{"l":"Welcome to 2FAuth Docs","p":["2FAuth is a web based self-hosted alternative to One Time Passcode (OTP) generators like Google Authenticator, designed for both mobile and desktop.","Screenshots of 2FAuth on mobile"]},{"l":"Why 2FAuth","p":["Two-Factor Authentication has become very popular in recent years, resulting in more and more situations where we face a security code request and an increase in the number of accounts protected by this technology. In other words, 2FA is now inevitable and critical.","2FAuth's purpose is to simplify how you use and manage your 2FA with a clean and suitable interface, no matter what device you use. In front of your computer without your smartphone and dealing with a code request? No problemo, just open your 2FAuth instance in a browser tab and voilÃ !","Moreover, as an open source and self-hosted application, it lets you regain control over your personal security data, giving you privacy and the ability to back it up (Have you lost a smartphone with all your 2FA accounts inside Google Auth? I did... it really sucked)"]},{"l":"Features"},{"l":"Generate passwords","p":["The main purpose of 2FAuth: Serve you some fresh TOTP/HOTP security codes aka One-Time Passwords."]},{"l":"Work anywhere","p":["It's a Web App, it just works, whatever device you're on. You only need one device (not even yours) and an Internet connection."]},{"l":"QR codes scan","p":["Scan and decode QR codes to add a 2FA account in no time. Actually, it decodes any QR code, even non 2FA."]},{"l":"2FA management","p":["Manage your 2FA accounts, organize and classify them using Groups, edit & delete them. You can even manually add an account without scanning a QR code."]},{"l":"Protect your data","p":["2FAuth protects your data with Privacy, Self-hosting, Encryption, WebAuthn authentication, OTP obfuscation, and Auto lock."]},{"l":"Multi-user","p":["Share your instance with your family, your friends. Everyone can have an account."]},{"l":"Import / Export","p":["Migrate from another 2FA app to 2FAuth or export your 2FA data in a breeze."]},{"l":"REST API","p":["2FAuth provides a REST API which lets you perform most of its functionalities from any external application. Have a look at the API documentation to find out how to use it."]},{"l":"Demo website","p":["Want to try 2FAuth? A demo is available at https://demo.2fauth.app","You can connect using the email address demo@2fauth.app and the password demo. The demo is reset every hour."]},{"l":"Browser extensions","p":["By design, 2FAuth is always at your fingertips: Through a pinned tab, shortcuts, or PWA installation. Browser extensions complement this feature by offering OTP generation directly from your browser toolbar.","Note: You must have a running instance of 2FAuth to use these extensions; they are not standalone."]}],[{"l":"Self-hosted server","p":["You can deploy 2FAuth on your own web server, whether on your local computer or a web host. The following guide describes how to proceed and gives basic configurations for both NGINX and Apache2 web servers."]},{"l":"Requirements"},{"l":"HTTP server","p":["Apache and NGINX are the most popular web servers. If you rent a server or web hosting, you probably already have one of them installed. If you plan to use your own machine and need help installing and configuring a web server, please consider searching the Web, as there are many tutorials to guide you through.","Google search for install apache2","Google search for install nginx"]},{"l":"PHP","p":["PHP >= 8.1","BCMath PHP Extension","Ctype PHP Extension","Fileinfo PHP Extension","JSON PHP Extension","Mbstring PHP Extension","OpenSSL PHP Extension","PDO PHP Extension","Tokenizer PHP Extension","XML PHP Extension","Depending on the chosen database (see below), don't forget to install the corresponding PHP extension (i.e php8.1-sqlite3 or php8.1-mysql)"]},{"l":"Database","p":["You need a database to run 2FAuth. Supported databases are the ones supported by Laravel.","MariaDB 10.2+","MySQL 5.7+","PostgreSQL 9.6+","SQLite 3.8.8+","SQL Server 2017+","2FAuth is a very light application with minimal needs and few concurrent connections. SQLite is definitely the best choice if you plan to use 2FAuth in a single-user context or in a multi-user context with a limited number of users. Otherwise prefer a server-based SQL database."]},{"l":"Composer","p":["You need Composer to install all PHP dependencies of 2FAuth. As the installation process of Composer may change depending on your operating system, please follow the instructions provided on the official website:","Install Composer","You can test your installation by running php composer.phar -v in a terminal (or just composer -v if composer has been installed in a directory that is part of your system PATH)"]},{"l":"Get your 2FAuth copy","p":["Here are 3 methods to help you download the 2FAuth source code. For the purpose of this guide we will consider /var/www/2fauth(which is a common path in the * nix world) to be the location where 2FAuth will sit. Of course, you are free to use another path, just remember to adapt the commands in the following steps with yours.","Download the source code of the latest 2FAuth release, say v4.1.0","Extract the archive and open the 2fauth-4.1.0 folder it contains","Move its content to /var/www/2fauth","Get the latest release","Get a specific release"]},{"l":"Installing dependencies"},{"i":"composer-1","l":"Composer","p":["From the /var/www/2fauth/ directory:","Or if you didn't add composer to your system PATH:"]},{"l":"Web server configuration","p":["As a reminder, the intended installation path is /var/www/2fauth. The given commands/scripts should be modified if you are using another path.","Set your NGINX configuration in /etc/nginx/nginx.conf as :","You can verify the Nginx configuration is valid with:","Add a new virtual host:","Add the following to the newly created file:","Remember to replace example.com with your domain","Save and close the file, then enable the new VHost and restart Apache2:"]},{"l":"Custom base url","p":["You may access 2FAuth from a custom base url, like mydomain.org/2fauth/. This is helpful if you do not want to define a dedicated (sub-)domain for 2FAuth.","For such a setup, you only need to add an alias to your existing server configuration:"]},{"l":"Create the database","p":["Use the CLI of the chosen database to create a new database with one of the following commands:","Reference","Command Line Shell For SQLite","Creating database with MySQL Creating database with MariaDB","Creating database with PostgreSQL","If you are not comfortable with the command line, you may use a db management tool like Adminer to ease this step.","Get Adminer"]},{"l":"2FAuth set up (wizard)","p":["2FAuth provides an artisan command to set up everything easily. If you want to set up all by hand, please follow the next section: 2FAuth set up (manual)."]},{"l":"Prerequisites","p":["Except if you want to use sqlite (in this case the wizard create the db file for you) you need a database server up and running for which you will provide the url."]},{"l":"Execution","p":["Open a command prompt on /var/www/2fauth/, run the following command and answer the wizard questions.","At the end of the wizard, 2FAuth should be ready to start. Please see Troubleshooting if something goes wrong.","You should review the email configuration section of the .env file to allow 2FAuth to send emails during the reset password process.","What the wizard do for you is :","Create the .env file","Configure general environment variables","Configure and migrate the database","Configure the authentication passport","Create the symbolic link for the storage location","Cache the configuration","All these steps are detailed below if you want to dive into them."]},{"l":"2FAuth set up (manual)"},{"l":"Set the .env file","p":["Run the following command from the /var/www/2fauth directory to create a fresh .env file from the .env.example template:","Open the .env file with a text editor, you will find the main environment variables that could be customized. You won't have to set/change all, most of them have a default value that will probably fit your needs. But some parts must be reviewed.","See Configuration to learn about all the environment variables that can be set."]},{"i":"database-1","l":"Database","p":["Set the path to your SQLite database file:","Uncomment the dedicated lines (and comment the SQLite ones) and replace values with yours:"]},{"l":"Email","p":["Email configuration depends on your email provider. You should refer to its documentation to find the relevant values. As an example, here is the configuration for an OVH hosting:"]},{"l":"Subdirectory","p":["In case you previously configured your web server to serve 2FAuth from a custom-base url like mydomain.org/2fauth/ you must edit the APP_SUBDIRECTORY.env var to match the server configuration.","To complete the custom base url configuration, open the file /var/www/2fauth/public/.htaccess, uncomment the RewriteBase directive and edit the subdir value to match the APP_SUBDIRECTORY value:"]},{"l":"Run Artisan commands","p":["Run the following Artisan commands from the /var/www/2fauth/ directory to set up the Laravel part:"]}],[{"l":"Docker CLI","p":["An official Docker image is available to run 2FAuth in a single Docker container. These are the Docker CLI Setup instructions, a docker-compose.yml file is also available."]},{"l":"Features","p":["Compatible with: amd64, 386, arm64, arm/v6 and arm/v7","Stores data in a Sqlite database file","Runs without root as user with id 1000 and group id 1000"]},{"l":"Tags","p":["Several Docker tags are available to let you choose which version you want to run:","Description","latest","The current state of the master branch. Considered stable. May include some fixes/changes not yet officially released.","Release tags: 3.0.2 3.1.0... x.y.z","The version at a corresponding GitHub release. Considered stable, and frozen.","dev","The current state of the dev branch May be unstable or even broken.","Simply append the tag name to the docker image name in your command or script, separated by a colon, to specify which tag to use. e.g 2fauth/2fauth:3.0.2, or 2fauth/2fauth:dev.","If no tag is specified, Docker will default to latest."]},{"l":"Docker CLI Setup","p":["We assume your current directory is /yourpath.","Create a directory on your host","Since the container runs without root as user 1000:1000, you need to fix the ownership and permissions of that directory:","If you feel like using another ID, you can build the image with build arguments.","Run the container interactively","Access it in your browser","localhost:8000","You can stop it with CTRL+C.","You can also run it in the background by replacing -it --rm with -d.","You can set available environment variables with -e, for example -e APP_NAME=2FAuth.","See Configuration to learn about all the environment variables that can be set."]},{"l":"Use an existing SQLite file","p":["If you already have an SQLite file, move it to /yourpath/2fauth/database.sqlite on your host before starting the container. Don't forget to fix its ownership and permissions if you run on * nix:","The container will automatically pick it up."]},{"l":"Build the image","p":["You can build the image from the master branch with docker and git using:"]},{"l":"Build the image for a specific release","p":["You can build a specific release by appending the release tag with #release-tag to the command. For example:"]},{"l":"Build the image for a specific commit","p":["You can build a specific commit (see master's commits) by appending the commit hash with #commit-hash to the command. For example:"]},{"l":"Build the image with build arguments","p":["1000","2.1","8.1-buster","an unknown date","Build argument","buster-slim","COMMIT","COMPOSER_VERSION","CREATED","DEBIAN_VERSION","Default","Description","GID","PHP_VERSION","SUPERVISORD_VERSION","The commit hash of the Git commit used","The date of the image build time","The Debian version to use","The GID of the user to run the container as","The PHP version to use to get composer dependencies","The UID of the user to run the container as","The version of composer to use","The version of supervisord to use","The version of the image","UID","unknown","Use the following build arguments to customize the image with --build-arg key=value:","v0.7.3","VERSION"]},{"l":"Mail settings","p":["2525","Build argument","Default","Description","Example:","MAIL_FROM_ADDRESS","MAIL_FROM_NAME","MAIL_HOST","MAIL_PASSWORD","MAIL_PORT","MAIL_USERNAME","null","smtp.mailtrap.io","The corresponding SMTP port","The sender email address","The sender name","The SMTP hostname","The SMTP password","The SMTP username"]},{"l":"Implementation details","p":["The final Docker image is based on alpine:3.14 with minimal packages installed","The container runs supervisord to handle both an Nginx server and a PHP-FPM server together","The /srv directory holds the repository data and PHP code.","The /2fauth directory is targeted for the container end users.","By default, the container logs the Nginx logs and the PHP-FPM logs. The application logs (if any) can be found in /2fauth/storage/logs."]}],[{"l":"Docker-Compose","p":["You can run 2FAuth with Docker-Compose using the following command and docker-compose.yml file:"]}],[{"l":"Heroku","p":["You can deploy 2FAuth to Heroku by clicking the button below:"]},{"l":"Restrictions","p":["Heroku uses an ephemeral filesystem, which means 2FAuth cannot use this file system to store and retrieve the 2FA icons across multiple sessions. For now, the only workaround is to disable icon display in 2FAuth:","Uncheck the option in the 2FAuth's Settings > Options section"]},{"l":"Configuration","p":["Although the Heroku button tends to ease the installation process, you have to configure some environment variables when creating the apps at Heroku."]},{"l":"Security keys","p":["2FAuth needs an RSA key pair for Laravel Passport to generate security tokens. Normally, these keys are generated automatically and stored in a 2FAuth subfolder, but the Heroku ephemeral filesystem breaks this behavior. You have to generate the keys on your own and then set the corresponding env vars."]},{"l":"Generate RSA keys","p":["Run the following command to generate a private private.pem RSA key:","Then derivates a public key public.pem from the newly created private.pem key:","Despite this is not a good security practice, you can also use an online generator like https://cryptotools.net/rsagen"]},{"l":"Set Heroku env vars","p":["Set the PASSPORT_PRIVATE_KEY environment var with the content of the private.pem file. Set the PASSPORT_PUBLIC_KEY environment var with the content of the public.pem file.","They should look like this:","Do NOT use those keys, they are provided as an example"]},{"l":"Email","p":["When using the Deploy to Heroku button, you will be prompted to set email vars for a basic SMTP configuration. It will be appropriate most of the time, but this is not the only possible configuration supported by Laravel.","Email setup is only needed for the 2FAuth 'Recover your password' feature. You can skip it if you just want to try 2FAuth.","The Email configuration depends on your email provider. You should refer to its documentation to find the relevant values. As an example, here is the configuration for an OVH hosting using SSL:","Read more about email configuration at https://laravel.com/docs/mail."]},{"l":"Free resources","p":["2FAuth offers a basic Heroku setup which only uses free resources: A single add-ons, Heroku Postgres with Hobby plan, and a single Web Dyno with NGINX. This way, any Heroku user can deploy the app, even if the user account is not verified.","Be aware that the Postgres has some limitations, but that should not be a problem as 2FAuth has very few database needs. Read more about the Heroku Postgres plans at devcenter.heroku.com"]}],[{"l":"YunoHost","p":["YunoHost is a libre operating system aiming to simplify server administration and democratize self-hosting.","2FAuth is part of the Yunohost Apps catalog, you can install it easily like any other Yunohost application."]},{"l":"Prerequisites","p":["This guide assumes you already have a Yunohost running instance."]},{"l":"Installation","p":["Open the Applications manager from the Yunohost Admin","Click the button","Search for 2FAuth","Click the button of the 2FAuth item","Install 2FAuth from the App catalog","Check and adjust the Install settings section and click the button","Wait for the installer to complete its job","Browse back to the Apps manager and click the 2FAuth item to find out its URL","The 2FAuth URL"]}],[{"l":"Environment variables"},{"l":"Purpose","p":["Here are the main environment variables that may be set to make 2FAuth work according to its running environment and to meet your needs. It is recommended to review them at least once to ensure minimal requirements are met and to have a picture of what 2FAuth offers in terms of configuration.","Asterisks next to the var names aim to identify important vars:","A blue asterisk indicates that the var should be set with a suitable value, otherwise 2FAuth may not work as expected.","A red asterisk indicates that the var must be set, otherwise 2FAuth will not work at all.","Set only the vars that need to be ajusted. If a var is not set, its default value will be applied."]},{"l":"How To","p":["You can set environment variables in various ways, depending on the running environment you chose.","When 2FAuth is deployed directly on a server (e.g. a VM or a bare metal server), the most straightforward method is to edit the .env file you should have set up during the installation process.","The .env.example file sets most of these variables for the sole purpose of guiding the user during the configuration of 2FAuth.","When running 2FAuth from a Docker container, you can use the -e [variable_name]=[new_value] or the --env-file [path_to_env_file] command-line arguments with the docker run command, or set the variables in a docker-compose file.","Ways to set environment variables with Compose","Set environment variables with docker run","The configuration may have been cached. If so, clear the cache before editing the environment variable:","Run php artisan config:clear OR","Delete the file [2FAuth_directory]/bootstrap/cache/config.php","Once variables have been modified, (re)build the cache by running php artisan config:cache"]},{"l":"General setting"},{"l":"APP_NAME","p":["The name of the application. It is used when the app name needs to place in a notification or any other location as required by the application or its packages.","2FAuth"]},{"l":"APP_ENV","p":["Determines the \"environment\" 2FAuth is currently running in.","If you change it to production, most Artisan console commands will ask for extra confirmation.","Do not set it to testing unless you run dev tests as some features will be disabled.","local, testing, production","local"]},{"l":"APP_TIMEZONE","p":["The timezone for your application, which is used to record dates and times to database.","This global setting can be overridden by users via in-app settings for a personalised dates and times display.","If this setting is changed while the application is already running, existing records in the database won't be updated.","See List of TZ database time zones Default value","UTC"]},{"l":"APP_DEBUG","p":["When 2FAuth is in debug mode, detailed error messages with stack traces will be shown on every error that occurs within 2FAuth.","If disabled, a simple generic error page is shown.","false"]},{"l":"APP_KEY","p":["The encryption key for all security related features (sessions, DB encryption, webauthn, personal access token)","Keep this very secure. If you loose it or generate a new one, all existing encrypted data in db must be considered LOST.","You can generate a key with the php artisan key:generate command.","none"]},{"l":"APP_URL","p":["The web address (URL) of your 2FAuth instance, e.g. https://2fauth.mydomain.com","Ensure the value you set uses the https scheme when 2FAuth is reached through a secure connection","If a custom port is used, it must be appended to the URL: https://2fauth.mydomain.com:8001","This must match your instance's external address (the location in your browser address bar) otherwise you'll get a blank page or WebAuthn authentication won't work.","http://localhost"]},{"l":"ASSET_URL","p":["The URL of your 2FAuth assets (CSS & JS files), e.g. https://2fauth.cdn.com","Only set this variable if you want to serve assets from a location other than your primary server, such as a CDN. Otherwise, do not set this variable.","Fallbacks to the APP_URL value when the var is not set."]},{"l":"APP_SUBDIRECTORY","p":["The domain subdirectory from which you want to serve 2FAuth.","This must reflect the path targeted by APP_URL.","Example:","If you previously set APP_URL to https://mydomain.org/2fa to access 2FAuth from the /2fa/ subdirectory, you have to set APP_SUBDIRECTORY=2fa.","Leave blank if you serve 2FAuth from the domain root.","blank"]},{"l":"IS_DEMO_APP","p":["Makes the 2FAuth instance behave like a demonstration app.","In Demo mode, the app displays some banners and disables certain features such as the password reset.","You can feed a demo app with fake data using the artisan command php artisan 2fauth:reset-demo.","Setting IS_DEMO_APP to true is mandatory for this command to run.","false"]},{"l":"API setting"},{"l":"THROTTLE_API","p":["The maximum number of API calls in a minute from the same IP. Once reached, all requests from this IP will be rejected until the minute has elapsed.","Set to null to disable the API throttling.","60"]},{"l":"Authentication setting"},{"l":"LOGIN_THROTTLE","p":["The number of times per minute a user can fail to log in before being locked out.","Once reached, all login attempts will be rejected until the minute has elapsed. This setting applies to both email/password and webauthn login attemps.","5"]},{"l":"AUTHENTICATION_GUARD","p":["The authentication guard used to perform users authentication.","Accepted values","The default guard to handle web authentications, such as login/password or webauthn.","A guard to handle authentication previously made by an auth proxy (like nginx or authelia) in front of 2FAuth.","2FAuth only look for the dedicated headers and skip all other built-in authentication checks. That means your proxy is fully responsible of the authentication process, 2FAuth will trust him as long as headers are presents.","Additional variable is required to be set with this guard:","AUTH_PROXY_HEADER_FOR_USER","Additional variable may be set with this guard:","See the dedicated auth proxy page to discover how to configure the reverse-proxy-guard.","web-guard","AUTH_GUARD"]},{"l":"AUTHENTICATION_LOG_RETENTION","p":["The authentication log retention time, in days.","Log entries older than that are automatically deleted.","365"]},{"l":"AUTH_PROXY_HEADER_FOR_USER","p":["Name of the HTTP header sent by the authentication proxy. This header identifies the user authenticated at proxy level.","Check your proxy documentation to find out how this header is named (i.e REMOTE_USER)","Only relevant when AUTHENTICATION_GUARD is set to reverse-proxy-guard.","REMOTE_USER"]},{"l":"AUTH_PROXY_HEADER_FOR_EMAIL","p":["Name of the HTTP header sent by the authentication proxy that provides the email address of the user authenticated at proxy level.","Check your proxy documentation to find out how this header is named (i.e REMOTE_EMAIL)","Only relevant when AUTHENTICATION_GUARD is set to reverse-proxy-guard.","null"]},{"l":"PROXY_LOGOUT_URL","p":["Custom logout URL to open when a user clicks the Logout link in 2FAuth. In most case this would send the user to the logout page of your authentication proxy.","Only relevant when AUTHENTICATION_GUARD is set to reverse-proxy-guard.","null"]},{"l":"WEBAUTHN_NAME","p":["Name of the Relying Party in the WebAuthn process. This should match the name of the application.","Do not set to null.","Fallbacks to the APP_NAME value when the var is not set."]},{"l":"WEBAUTHN_ID","p":["ID of the Relying Party in the WebAuthn process. This should equal the application domain (i.e 2fauth.example.com).","While only the WEBAUTHN_NAME is enough, you can further set a custom domain as ID. If set to null, the device will fill it internally.","See How to determine the relying party id for more information.","null"]},{"l":"WEBAUTHN_USER_VERIFICATION","p":["Setting to control how user verification behave during the WebAuthn authentication flow.","See WebAuthn user verification.","Accepted values","Will ALWAYS ask for user verification","Will ask for user verification IF POSSIBLE","Will NOT ask for user verification (for example, to minimize disruption to the user interaction flow)","preferred"]},{"l":"Cache setting"},{"l":"CACHE_DRIVER","p":["A distributed memory object caching system ( memcached.org)","Accepted values","An in-memory data structure store, used as a database, cache, and message broker ( redis.io)","CACHE_STORE","Convenient cache backend for automated tests","Data are cached to the database set with database setting.","Data are cached to the filesystem","file","See how to configure the Database driver on the Laravel documentation.","See how to configure the DynamoDB driver on the Laravel documentation.","See how to configure the Memcached driver on the Laravel documentation.","See how to configure the Redis driver on the Laravel documentation.","Serverless, NoSQL, fully managed database with single-digit millisecond performance at any scale ( dynamodb)","The default cache store used by 2FAuth when executing caching functions","This driver requires the creation of an additional database table and the installation of the AWS SDK php package.","This driver requires the installation of an additional package.","This driver requires the installation of an additional PECL package."]},{"l":"Database setting","p":["See Database configuration for information on how to use these variables together."]},{"l":"DB_CONNECTION","p":["The database driver to be used.","Accepted values","MySQL database","PostgreSQL database","SQL Server database","SQLite database","mysql"]},{"l":"DB_DATABASE","p":["Name of the database (when using mysql, pgsql and sqlsrv drivers) or path to the sqlite file","Using sqlite under Windows, path separators have to be escaped: C:\\\\path\\\\to\\\\database.sqlite","2fauth"]},{"l":"DB_HOST","p":["Address of the resource hosting your database.","Does not apply to sqlite.","127.0.0.1"]},{"l":"DB_PORT","p":["Port used to communicate with the database host.","Does not apply to sqlite.","For MySQL: 3306","For PostgreSQL: 5432","For SQL Server: 1433"]},{"l":"DB_USERNAME","p":["The username used to connect to the database.","Does not apply to sqlite.","2fauth"]},{"l":"DB_PASSWORD","p":["The password used to connect to the database.","When using .env file, if the password contains special characters like #, put quotes around it. Does not apply to sqlite.","An empty string"]},{"l":"DB_CHARSET","p":["The character set of the database.","Does not apply to sqlite.","For MySQL: utf8mb4","For PostgreSQL: utf8","For SQL Server: utf8"]},{"l":"DB_COLLATION","p":["The collation of the database.","Only applies to mysql.","utf8mb4_unicode_ci"]},{"l":"DATABASE_URL","p":["A single database \"URL\" that contains all of the connection information for the database in a single string, i.e:","mysql://root:password@127.0.0.1/forge?charset=UTF-8","If set, 2FAuth will use it to extract the database connection and credential information. Other DB_* vars are then useless.","none","DB_URL"]},{"l":"MYSQL_ATTR_SSL_CA","p":["Absolute path to the root CA bundle if you're connecting to the MySQL database via SSL","null"]},{"l":"Email setting"},{"l":"MAIL_MAILER","p":["(See accepted values of LOG_CHANNEL)","Accepted values","Additional variable is required to be set with this driver:","Additional variable may be set to customize the sendmail driver configuration:","Additional variables are required to be set with this driver:","Additional variables may be set to customize the smtp driver configuration:","AWS_ACCESS_KEY_ID","AWS_DEFAULT_REGION","AWS_SECRET_ACCESS_KEY","Backup mail delivery configurations that will be used in case your primary delivery driver is down","Instead of sending your emails, the log mail driver will write all email messages to your log files for inspection.","MAIL_ENCRYPTION","MAIL_HOST","MAIL_LOG_CHANNEL","MAIL_PASSWORD","MAIL_PORT","MAIL_SENDMAIL_PATH","MAIL_USERNAME","MAIL_VERIFY_SSL_PEER","MAILGUN_DOMAIN","MAILGUN_ENDPOINT","MAILGUN_SECRET","POSTMARK_TOKEN","See how to configure the Mailgun Driver on the Laravel documentation.","See how to configure the Postmark Driver on the Laravel documentation.","See how to configure the SES Driver on the Laravel documentation.","smtp","The default mailer that is used to send any email messages sent by 2FAuth.","Use a sendmail server to send emails.","Use an SMTP server to send emails.","Use the Amazon SES API to send emails.","Use the mail log channel to send emails.","Use the mailgun API to send emails.","Use the postmark API to send emails."]},{"l":"MAIL_USERNAME","p":["Username used to connect to the SMTP server","none"]},{"l":"MAIL_PASSWORD","p":["Password used to connect to the SMTP server.","When using .env file, if the password contains special characters like #, put quotes around it.","none"]},{"l":"MAIL_ENCRYPTION","p":["Encryption protocol used to secure email delivery.","This var applies only to the smtp driver.","tls"]},{"l":"MAIL_HOST","p":["Domain of the mail server.","This var applies only to the smtp driver.","smtp.mailtrap.io"]},{"l":"MAIL_PORT","p":["Port used to communicate with the mail server.","This var applies only to the smtp driver.","587"]},{"l":"MAIL_FROM_NAME","p":["Name that is used globally for all e-mails that are sent by 2FAuth","Example"]},{"l":"MAIL_FROM_ADDRESS","p":["Address that is used globally for all e-mails that are sent by 2FAuth","hello@example.com"]},{"l":"MAIL_VERIFY_SSL_PEER","p":["SSL peer verification.","Disabling peer verification may result in a major security flaw. Change it only if you know what you're doing.","This var applies only to the smtp driver.","true"]},{"l":"MAIL_SENDMAIL_PATH","p":["Path to the sendmail binary","/usr/sbin/sendmail -bs -i"]},{"l":"Logs management","p":["The following variables allow you to configure your logging strategy with out-of-the-box options. The Laravel documentation provides more information on how to configure advanced logging options to meet specific needs."]},{"l":"LOG_CHANNEL","p":["A wrapper to facilitate creating \"multi-channel\" channels.","Accepted values","Additional variable is required to be set with this channel:","Additional variable may be set to change the number of files:","Additional variable may be set to customize the channel:","Additional variable may be set to define the stack:","Additional variables are required to be set: PAPERTRAIL_URL URL of the papertrail instance PAPERTRAIL_PORT Port used to communicate with the papertrail instance","Additional variables may be set to customize the channel:","daily","Gives you 7 daily rotated log files in [2FAuth_directory]/storage/logs/.","Gives you one big fat error log file at in [2FAuth_directory]/storage/logs/laravel.log","LOG_DAILY_DAYS","LOG_SLACK_EMOJI","LOG_SLACK_USERNAME","LOG_SLACK_WEBHOOK_URL","LOG_STACK","LOG_SYSLOG_FACILITY","The log channel defines where your log entries go to.","Writes entries to a Papertrail instance.","Writes entries to a Slack channel.","Writes entries to the error log","Writes entries to the system log"]},{"l":"LOG_STACK","p":["The stack of log channels used when LOG_CHANNEL is set to stack.","A comma-separated list of valid LOG_CHANNEL: daily, single, errorlog, syslog, papertrail, slack","Ex: slack, papertrail","daily"]},{"l":"LOG_LEVEL","p":["Determines the minimum \"level\" a message must be in order to be logged.","If you set it to debug your logs will grow large, and fast. If you set it to emergency probably nothing will get logged, ever.","From least severe to most severe:","debug, info, notice, warning, error, critical, alert, emergency","See RFC 5424 for level definitions.","notice"]},{"l":"LOG_DAILY_DAYS","p":["Number of log files to generate/rotate when using the daily log channel.","7"]},{"l":"LOG_SLACK_WEBHOOK_URL","p":["URL of the Slak webhook to use when using the slack log channel.","none"]},{"l":"LOG_SLACK_USERNAME","p":["The name of the user sending the log messages when using the slack log channel.","Laravel Log"]},{"l":"LOG_SLACK_EMOJI","p":["The Emoji code of the emoji used to illustrate log messages when using the slack log channel.",":boom:"]},{"l":"LOG_SYSLOG_FACILITY","p":["The syslog facility that provides a rough clue of where in a system the message originated. Only applies when log channel is set to syslog.","LOG_USER"]},{"l":"LOG_DEPRECATIONS_CHANNEL","p":["A log channel to use to log the PHP & Laravel deprecation warnings.","Should match one of the channels described at LOG_CHANNEL","null"]},{"l":"Proxy setting"},{"l":"TRUSTED_PROXIES","p":["A comma separated IP list of trusted proxies.","When running 2FAuth behind a proxy that terminates TLS / SSL certificates, you may face some errors. Typically this is because 2FAuth is being forwarded traffic from the proxy on port 80 and does not know it should generate secure links.","Set to * to trust any proxy.","null"]},{"l":"PROXY_FOR_OUTGOING_REQUESTS","p":["Proxy for outgoing requests, like SSO connection, 2FAuth releases detection or logo fetching.","You can provide a proxy URL that contains a scheme, username, and password. For example http://username:password@192.168.16.1:10.","blank"]},{"l":"PROXY_HEADER_FOR_IP","p":["Name of the HTTP header sent by a reverse proxy to pass the original visitor IP address.","Check the proxy documentation to find out how this header is named (i.e HTTP_CF_CONNECTING_IP for cloudflare).","null"]},{"l":"Security setting"},{"l":"HASH_DRIVER","p":["The hash algorithm used to hash user passwords.","Changing the hash driver while some users have already registered will break authentication. This var must be set before any user registration.","Accepted values","bcrypt, argon, argon2id",":"]},{"l":"BCRYPT_ROUNDS","p":["Number of rounds when passwords are hashed using the Bcrypt algorithm.","Increasing this up to 12 or even 13 will benefit to password security. Be careful, a higher value may significantly affect performance.","10"]},{"l":"ARGON_MEMORY","p":["Maximum memory (in kibibytes) that may be used to compute an Argon2 hash.","65536"]},{"l":"ARGON_THREADS","p":["Number of threads that Argon2 will use to compute a hash.","1"]},{"l":"ARGON_TIME","p":["Maximum amount of time it may take to compute an Argon2 hash.","4"]},{"l":"Session setting"},{"l":"SESSION_DRIVER","p":["Accepted values","Additional variables may be set when using this driver:","An in-memory data structure store, used as a database, cache, and message broker ( redis.io)","file","In-memory key-value store for PHP","See CACHE_DRIVER","See how to configure DynamoDB driver on the Laravel documentation.","See how to configure the Database driver on the Laravel documentation.","See how to configure the Redis driver on the Laravel documentation.","Serverless, NoSQL, fully managed database with single-digit millisecond performance at any scale ( dynamodb)","SESSION_TABLE","Sessions are stored in [2FAuth_directory]/storage/framework/sessions","sessions are stored in a PHP array and will not be persisted","Sessions are stored in Memcached.","Sessions are stored in secure, encrypted cookies","Sessions are stored in the database set with DB_CONNECTION.","The default session driver used by 2FAuth to store sessions","This driver requires the creation of an additional database table","This driver requires the creation of an additional database table and the installation of the AWS SDK php package.","This driver requires the installation of an additional package.","This driver requires the installation of an additional PECL package."]},{"l":"SESSION_CONNECTION","p":["When using the database or redis session drivers, you may specify a connection that should be used to manage these sessions.","This should correspond to a connection in your database configuration options.","none"]},{"l":"SESSION_STORE","p":["While using one of the framework's cache driven session backends you may list a cache store that should be used for these sessions.","This value must match with one of the 2FAuth's configured cache stores.","apc, dynamodb, memcached, redis","(see CACHE_DRIVER)","none"]},{"l":"SESSION_TABLE","p":["Name of the table to be used to store sessions when using the database session driver. See SESSION_DRIVER.","sessions"]},{"l":"SESSION_COOKIE","p":["Name of the cookie used to identify a session instance by ID.","The name specified here will get used every time a new session cookie is created by 2FAuth for every driver.","2fauth_session"]},{"l":"SESSION_DOMAIN","p":["Domain of the cookie used to identify a session in 2FAuth.","This will determine which domains the cookie is available to in 2FAuth.","Fallbacks to the 2FAuth instance domain"]},{"l":"SESSION_SECURE_COOKIE","p":["By setting this option to true, session cookies will only be sent back to the server if the browser has a HTTPS connection.","This will keep the cookie from being sent to you when it can't be done securely.","false"]},{"l":"SESSION_ENCRYPT","p":["Whether or not session data are encrypted before it is stored.","false"]},{"l":"SSO setting","p":["See Single Sign-On (SSO) to discover how to enable SSO on your instance."]},{"l":"OPENID_AUTHORIZE_URL","p":["URL used during the OpenID SSO flow to request the user's authentication and consent","none"]},{"l":"OPENID_TOKEN_URL","p":["URL used during the OpenID SSO flow to obtain an ID and / or access token","none"]},{"l":"OPENID_USERINFO_URL","p":["URL used during the OpenID SSO flow to retrieve profile information and other attributes for a logged-in end-user","none"]},{"l":"OPENID_CLIENT_ID","p":["A unique identifier for the application","none"]},{"l":"OPENID_CLIENT_SECRET","p":["Secret known only to 2FAuth and the Open ID authorization server","none"]},{"l":"GITHUB_CLIENT_ID","p":["A unique identifier for the application","none"]},{"l":"GITHUB_CLIENT_SECRET","p":["Secret known only to 2FAuth and Github","none"]}],[{"l":"User preferences"},{"l":"Purpose","p":["User preferences are settings that any user can change to customize the behavior or appearance of 2FAuth. They can be set by the user from the Settings > Options section of 2FAuth. As the name implies, when a user edits a preference, it only affects their own use, not that of other users.","2FAuth comes with a set of default values for user preferences. These defaults are defined to provide a good starting experience for every user, but as an administrator, you may want to control them for a consistent, streamlined, or corporate user experience. 2FAuth supports 2 ways to accomplish this:","2FAuth defaults are overridden with your default values.","When a preference's default is customized, the custom value is applied to all users who didn't already personalized the preference themselves from the Settings > Options page of 2FAuth. The preference can still be modified by user.","Preferences are locked for change to user.","Regardless of the value of the preference, no user can edit a locked preference from the Settings > Options section of 2FAuth. The applied value is the last one, according to this priority order:","By the user","The custom default (if defined)","The 2FAuth default","The two features can be combined for a complete control over the preferences:","Your custom defaults are enforced for all users.","Regardless of the value of the preference, no user can edit a locked preference from the Settings > Options section of 2FAuth. The applied value is yours, for everybody.","Custom defaults and preference locking are done by setting up dedicated environment variables. Read the Environment variables page to learn how to define them."]},{"l":"How to","p":["Configuration is done per preference. To customize or lock a user preference, add a new environment variable using the following format:","Where [PREFIX] is to be replaced with the expected behavior, [NAME_OF_THE_USER_PREFERENCE] with the name of the user preference you want to impact and [value] with the required value. (see Available preferences to discover the available preferences and their supported values)","Note the separator between the prefix and the var name, it's a double underscore: __","The 2 possible values to replace [PREFIX] are USERPREF_DEFAULT__ for setting a custom default value and USERPREF_LOCKED__ for locking. You have to set an environment variable for each behavior you want to apply.","A locking environment variable is only relevant if you want to lock a preference. If you don't need to, just don't declare such a variable, or delete the existing one."]},{"l":"Example","p":["Say you want to hide one-time password's icons in 2FAuth. The corresponding user preference is named SHOW_ACCOUNTS_ICONS. Here are the environment variables to set, depending on your needs:","Here is another example to control the theme of 2FAuth, given that the 2FAuth default for this preference is system(See THEME)"]},{"l":"Impact on running app","p":["Because of the way 2FAuth is built, adding new environment variables to enforce user preferences may not have an immediate effect if your 2FAuth instance is running.","You must rebuild the configuration cache of the app for the new variables to be loaded or restart your container if you use one. See the Environment variables section for details.","Also, logged-in users won't see any changes until they reconnect or visit the Settings > Options page of 2FAuth."]},{"l":"Available preferences","p":["AUTO_CLOSE_TIMEOUT","AUTO_SAVE_QRCODED_ACCOUNT","CLEAR_SEARCH_ON_COPY","CLOSE_OTP_ON_COPY","COPY_OTP_ON_DISPLAY","DEFAULT_CAPTURE_MODE","DISPLAY_MODE","FORMAT_PASSWORD","FORMAT_PASSWORD_BY","GET_OFFICIAL_ICONS","GET_OTP_ON_REQUEST","KICK_USER_AFTER","LANG","NOTIFY_ON_FAILED_LOGIN","NOTIFY_ON_NEW_AUTH_DEVICE","REMEMBER_ACTIVE_GROUP","REVEAL_DOTTED_OTP","SHOW_ACCOUNTS_ICONS","SHOW_EMAIL_IN_FOOTER","SHOW_NEXT_OTP","SHOW_OTP_AS_DOT","SORT_CASE_SENSITIVE","THEME","TIMEZONE","USE_BASIC_QRCODE_READER","USE_DIRECT_CAPTURE","VIEW_DEFAULT_GROUP_ON_COPY"]},{"l":"AUTO_CLOSE_TIMEOUT","p":["Time before the on-screen one-time password is automatically closed.","Only relevant when GET_OTP_ON_REQUEST is set to true.","2","Accepted values","Disables the auto-close feature, the popup containing the OTP will never be closed","Duration (in minutes) before the auto-close is triggered"]},{"l":"AUTO_SAVE_QRCODED_ACCOUNT","p":["Enables automatic registering of a 2FA account after scanning or uploading a QR code","false"]},{"l":"CLEAR_SEARCH_ON_COPY","p":["Clears the search field when a click/tap is done on a one-time password to copy it","false"]},{"l":"CLOSE_OTP_ON_COPY","p":["Closes the on-screen one-time password after a click/tap is done on it to copy it.","Only relevant when GET_OTP_ON_REQUEST is set to true.","false"]},{"l":"COPY_OTP_ON_DISPLAY","p":["Triggers OTP copy to clipboard when the OTP is displayed.","Only relevant when GET_OTP_ON_REQUEST is set to true.","false"]},{"l":"DEFAULT_CAPTURE_MODE","p":["Default input mode to use when Direct capture is enabled","Only relevant when USE_DIRECT_CAPTURE is set to true.","livescan","Accepted values","Launches the device camera for flashing QR codes","Prompt to upload a file from the device","Opens the advanced form"]},{"l":"DISPLAY_MODE","p":["The 2FA accounts display mode","list","Accepted values","Show 2FA accounts as a list","Show 2FA accounts as a grid"]},{"l":"FORMAT_PASSWORD","p":["Applies a digit formatting to one-time password display.","Additional preferences have to be set to refine this behavior:","FORMAT_PASSWORD_BY","true"]},{"l":"FORMAT_PASSWORD_BY","p":["Formatting pattern applied to one-time password display.","Only relevant when FORMAT_PASSWORD is set to true.","0.5","Accepted values","Groups password digits by half, like #### ####","Groups password digits by pair, like ## ## ##","Groups password digits by trio, like ### ###"]},{"l":"GET_OFFICIAL_ICONS","p":["Allows 2FAuth to fetch the web for official icons when registering a new 2FA account","true"]},{"l":"GET_OTP_ON_REQUEST","p":["Generates and displays one-time passwords in a dedicated popup, only when the user requests them by clicking on 2FA account titles.","When disabled, OTPs are always visible on the main screen, no action is required to generate or rotate them.","Additional preferences may be set to refine this behavior:","CLOSE_OTP_ON_COPY","AUTO_CLOSE_TIMEOUT","COPY_OTP_ON_DISPLAY","true"]},{"l":"KICK_USER_AFTER","p":["Action or inactivity time span that triggers the automatic disconnection of the user, aka Auto-lock","15","Accepted values","Disables the auto-lock feature, the user will never be logged out","Triggers user logout when a click/tap is done on a one-time password to copy it","Time (in minutes) before the user is automatically disconnected"]},{"l":"LANG","p":["The language used to translate the 2FAuth user interface","browser","Accepted values","Uses the preferred language setting of the browser used to visit 2FAuth.","The language code of any supported translation, for example fr, en or ja. See the Crowdin project page for the full list."]},{"l":"NOTIFY_ON_FAILED_LOGIN","p":["Enables email notification of failed login attempts","false"]},{"l":"NOTIFY_ON_NEW_AUTH_DEVICE","p":["Enables email notification of successful logon from a new device","false"]},{"l":"REMEMBER_ACTIVE_GROUP","p":["Saves the last group filter applied and restores it on your next visit","true"]},{"l":"REVEAL_DOTTED_OTP","p":["Displays a button to make the OTP readable while it is obfuscated.","Only relevant when SHOW_OTP_AS_DOT is set to true.","false"]},{"l":"SHOW_ACCOUNTS_ICONS","p":["Show/Hide the icons that depict 2FA accounts","true"]},{"l":"SHOW_EMAIL_IN_FOOTER","p":["Switch between the old footer layout and the new one that displays the email address of the currently logged in user","true"]},{"l":"SHOW_NEXT_OTP","p":["Previews the next OTP near the current valid OTP","false"]},{"l":"SHOW_OTP_AS_DOT","p":["Obfuscates OTPs by replacing digits with dots.","Additional preferences may be set to refine this behavior:","REVEAL_DOTTED_OTP","false"]},{"l":"SORT_CASE_SENSITIVE","p":["Applies case-sensitive sorting when reordering 2FA accounts","false"]},{"l":"THEME","p":["The theme applied to the app pages","system","Accepted values","Uses the website appareance setting of the browser used to visit 2FAuth","Uses a light theme for backgrounds and page content","Uses a dark theme for backgrounds and page content"]},{"l":"TIMEZONE","p":["The time zone applied to all dates and times displayed in the 2FAuth user interface","UTC","Any timezone identifier, for example Africa/Asmara. See List of TZ database time zones"]},{"l":"USE_BASIC_QRCODE_READER","p":["Switches to an alternative QR code reader","false"]},{"l":"USE_DIRECT_CAPTURE","p":["Skips the input mode selection screen.","Additional preferences have to be set to refine this behavior:","DEFAULT_CAPTURE_MODE","false"]},{"l":"VIEW_DEFAULT_GROUP_ON_COPY","p":["Always return to the default group filter when a click/tap is done on a one-time password to copy it","false"]}],[{"l":"Troubleshooting"},{"l":"Check logs","p":["Logs can give usefull informations to troubleshoot your installation. 2FAuth logs are stored in the subfolder storage/logs of your installation folder.","You may enable debug logs by setting APP_DEBUG=true and LOG_LEVEL=debug in your .env file.","The web server and the database server also provide some logs. Their locations may vary depending on the server choice and your operating system. If you followed the Web server configuration of this guide, the web server logs should be in one of these locations under a * nix system :"]},{"l":"Possible issues","p":["Try to recreate the symlink using relative path.","Open a terminal on the 2FAuth installation folder and run:","The .htaccess configuration should be modified.","Edit the /public/.htaccess file and add following lines:","right before:","If using Apache2, ensure permissions are set correctly.","Open a terminal and run:","Also, ensure mod_rewrite is enabled:","Your proxy should be registered via an enviroment variable.","Edit your .env file and set:","In case of multiple proxies, separate the addresses with a comma."]}],[{"l":"Upgrade"},{"l":"Self-hosted server","p":["Update the source code in /var/www/2fauth(see Get your 2FAuth copy)","Do not change the /var/www/2fauth/storage directory nor your /var/www/2fauth/database/database.sqlite file (when using SQLite)","Depending on how you update your files, you could have to set the permissions again:","Update the dependencies by running:","Then start the installation wizard by running:","The wizard automatically runs the following commands:"]},{"l":"Docker","p":["At the very least, backup your database.sqlite file to avoid bad surprises!","The Docker image 2fauth/2fauth is built on every commit pushed to the master branch. You can therefore pull the image with docker pull 2fauth/2fauth and restart the container to update it.","You can also use tagged images, see Docker Hub tags, which are produced on Github releases."]},{"l":"YunoHost","p":["Open the System update manager from the Yunohost Admin","In the Applications section, click the 2FAuth button","Wait for the installer to complete its job","You can also upgrade using the YunoHost command-line:"]}],[{"l":"Data protection","p":["2FAuth provides several security mechanisms to protect your sensitive 2FA data, at administrator or user level."]},{"l":"For administrators"},{"l":"DB encryption","p":["Sensitive data stored in the database (2FA secret & otpauth URI) can be encrypted to protect them against a database compromise.","Check the option in the 2FAuth's Admin > App setup section to enable encryption.","Encryption applies to all users data","It is strongly recommended to backup the APP_KEY value defined in your .env file (or the whole file) when encryption is enabled.","There is no way to generate One-Time Password if you lose this key. There is no workaround in case of key loss."]},{"l":"For users"},{"l":"Auto lock","p":["2FAuth can automatically log you out to keep your data always protected. The goal is to avoid a long life session that someone could reuse, for example from a public computer you forgot to clean or from your own stolen smartphone.","Supported trigger","Behavior","On security code copy","You will be logged out immediately after you click/tap on a One-Time Password to copy it","a time lapse","You will be logged out after a certain amount of time","Never","Disable the Auto lock","Use the combobox in the 2FAuth's Settings > Options section to select a trigger or to disable the feature."]},{"l":"Sensitive data hiding","p":["You can configure 2FAuth to display obfuscated One-Time Password rather than human readable password.","Without obfuscation","With obfuscation","377 609","âââ âââ","This protects against attacks like a shoulder-surfing attack, where a third party intercepts your password by watching over your shoulder as you generate a fresh password.","Of course, this is only suitable if you are able to use the copy/paste feature to provide the password to the destination service.","Simply click/tap the (obfuscated) password in 2FAuth to copy it!","Check the option in the 2FAuth's Settings > Options section to enable obfuscation."]}],[{"l":"Single Sign-On (SSO)","p":["Single sign-on is an authentication scheme that allows a user to log in with a single ID to any of several related, yet independent, software systems.( Wikipedia, CC Attribution-ShareAlike)","In other words, you can use an existing account, say your github account, to authenticate to 2FAuth.","SSO is probably overkill for a single user usage but becomes relevant in a multi-user context, especially if your organization already uses OAuth.","For now 2FAuth only supports 2 SSO providers: OpenID and Github"]},{"l":"Enabling SSO","p":["SSO is enabled by default. You can check it or change it at Admin > Auth.","SSO makes outgoing requests that you may want to pass through a proxy.","If so, set the PROXY_FOR_OUTGOING_REQUESTS environment variable."]},{"l":"Enable a provider"},{"l":"Create the client","p":["You have to create a client ID on the provider side first. This is required so that your 2FAuth instance is considered legit when requesting an access token to the provider.","Please refer to the vendor's documentation for instructions on how to do this. During the process, when/if asked:","Choose the Authorization code grant flow","Choose the Web application flow","The Authorization callback URL is to build as:[your_2FAuth_url]/socialite/callback/[the_provider_name]","Example:_ Your 2FAuth instance url is https://2fauth.mydomain.com_ Your provider is Github","Then your callback URL is: https://2fauth.mydomain.com/socialite/callback/github","At the end of the process, you should be provided with a Client ID & Secret. Copy them as they are needed to set up the provider on the 2FAuth side."]},{"l":"Usefull resources (for Github)","p":["Manage your OAuth apps","creating-an-oauth-app"]},{"l":"Set up the provider","p":["Setting up a provider is done by defining its dedicated environment variables on your 2FAuth instance. You can find these vars in the .env file of 2FAuth. See also the SSO setting section.","Uncomment the lines for the providers you want to enable and assign the values with the information you obtained previously during the client creation.","Uncommented providers but with empty CLIENT_ID or CLIENT_SECRET won't be available."]},{"l":"Sign with a provider","p":["Once a provider is enabled, a button to Continue with this provider is available on the 2FAuth's Login page.","Continue With buttons for SSO","Clicking a button will take you through the following steps:","You will be redirected to the provider site (where you may need to authenticate)","You will be prompted to grant permissions to 2FAuth to access your account","Regardless of your choice, you will be redirected back to 2FAuth","If you have granted access, you will be authenticated. If not, you will be back to the login form","You cannot sign in via SSO with a provider account that uses an email already registered on 2FAuth. Accounts cannot be merged."]},{"l":"Registered without registering","p":["When you sign in via SSO for the first time, you are registered to 2FAuth transparently. This means you own a 2FAuth user account on the instance but this account is bound to the provider account with the following restrictions:","You won't be provided with a password, but the reset password feature will apply if you need one (e.g. to delete your account)","The 2FAuth account cannot be unbound from the provider account.","You cannot change your information from 2FAuth. But changes made on the provider side are reflected on 2FAuth each time you sign in via SSO."]},{"l":"Use SSO only","p":["SSO can be set as the only authentication method available on your 2FAuth instance. Go to Admin > Auth, scroll down to the Single Sign-On section and check .","Enabling this setting has the following effects:","Most authentication features are disabled for standard users: Password & WebAuthn Login, Password Reset, Registration, OAuth PAT and WebAuthn devices management.","Administrators can still log in with their password or WebAuthn. This is a security feature to prevent lockout if no SSO provider is available."]},{"l":"Disabling SSO","p":["As an administrator, you can fully disable Single Sign-On from the 2FAuth UI.","Go to Admin > Auth, scroll down to the Single Sign-On section and uncheck .","Note that:","Existing \"SSO users\" won't be able to sign in via SSO anymore, but their accounts remain. Still, the password reset feature can be used so they can get a password and sign in again.","There is no need to unset the providers env vars.","Enabling back SSO restores the providers and the ability for SSO users to sign in again."]}],[{"l":"WebAuthn (aka Passkey)","p":["2FAuth supports the W3C Web Authentication API aka WebAuthn ( learn more). This means you can register a security device like a Yubikey, a Titan Security Key, or a facial recognition system like Apple FaceId and use it to log into 2FAuth.","image by Arun (dribbble.com/nullpointone)","This method is considered more secure, as it proves you are in fact you because you have to physically own the security device.","WebAuthn is available in 2FAuth as a complement or a replacement to the built-in login/password method. Consider using only WebAuthn to provide the highest protection to your 2FAuth instance.","The WebAuthn flow does not use login & password, but the creation of a user account with an email and a password remains mandatory."]},{"l":"Registering a security device","p":["2FAuth offers to register a WebAuthn device right after submitting the user registration form or through its Settings > Webauthn section. Whatever you choose, the registration process will be the same and depends on the hardware you use (desktop, laptop or smartphone) and how your browser implements the WebAuthn flow.","A typical workflow would be:","You click the link in 2FAuth","Your browser prompts you to grant the operation","You put your finger on the key's touch button","2FAuth registers the key and offers you to rename it","You can register several security devices, there is no limitation in the number of devices."]},{"l":"Revoking a security device","p":["You can revoke any registered security device through the Settings > Webauthn section. Simply click the relevant button.","The revocation of a device is permanent and cannot be undone."]},{"l":"I lost my device","p":["Don't worry, there is always a solution, depending on how you have configured 2FAuth's WebAuthn options.","If you have registered another device and still own it, just use this device to log in. Otherwise, you can recover your account by registering a new security device.","Click the Recover your account link of the 2FAuth's login form, this will send a link to your registered email address. Follow this link, you will be able to register a new device and revoke all existing ones.","Assuming you haven't lost your password too, switch the 2FAuth login form using the link Sign in using login & password and log in using your email address and password. It's that simple!","Don't forget to revoke the lost device in the Settings > Webauthn section."]},{"l":"User verification","p":["Most authenticators and smartphones will ask the user to actively verify themselves to log in. For example, through a touch plus pin code, password entry, or biometric recognition (e.g., presenting a fingerprint). The intent is to distinguish one user from any other.","You can configure how the user verification step behave during the WebAuthn login flow with the WEBAUTHN_USER_VERIFICATION env var:","Supported value","Behavior","required","Will ALWAYS ask for user verification","preferred(default)","Will ask for user verification IF POSSIBLE","discouraged","Will NOT ask for user verification (for example, to minimize disruption to the user interaction flow)"]}],[{"l":"Auth proxy","p":["You can configure 2FAuth to let an HTTP proxy handle authentication. In this case, 2FAuth will consider you logged in as long as you are authenticated at proxy level. This is particularly useful if you want to deploy 2FAuth behind a service like Sandstorm or behind an Auth server like Authelia.","2FAuth will check for an HTTP header, named REMOTE_USER by default, in every request from the proxy. (see RFC3875)","2FAuth only check for the header presence, nor its validity nor its content, so be sure your instance cannot be reached otherwise than through your auth proxy."]},{"l":"Enable the proxy guard","p":["Set the AUTHENTICATION_GUARD environment variable to reverse-proxy-guard to enable the auth proxy authentication.","WebAuthn and Personal Access Token are not supported when using the reverse-proxy-guard"]},{"l":"Define the header value","p":["The REMOTE_USER header can take any value. For 2FAuth, its value is the username of the user account to consider authenticated.","If you already have a user account in 2FAuth, set the REMOTE_USER header value (at proxy level) like the name field of your account.","If you do not have a user account yet, or if you want to be authenticated as a brand new user, set the header to a fresh value, 2FAuth will take care of creating the account for you."]},{"l":"Customize the header name","p":["You can customize the header name by setting the AUTH_PROXY_HEADER_FOR_USER environment variable to match a specific proxy configuration. For example, if the proxy header is 2FAUTH-User, then set AUTH_PROXY_HEADER_FOR_USER as such:","Some proxies may add a prefix to headers, like HTTP_. You have to add it to your headers name as well."]},{"l":"Additional header","p":["You can configure 2FAuth to check for an additional header that contain the authenticated user email address. This header may or may not exist depending on the auth proxy configuration. Its name should be declare using the environment variable AUTH_PROXY_HEADER_FOR_EMAIL.","As long as the header is sent by the proxy, its value will be used by 2FAuth as the user email address.","The email passed through the header must be a valid and unused email. If a 2FAuth user already uses this email, 2FAuth will ignore it.","If the header is no longer sent (or is ignored), the user's email will be fallbacked to a fake @remote email adress by 2FAuth."]}],[{"l":"Personal Access Token","p":["Use Personal Access Tokens (PAT) to authenticate requests sent to the 2FAuth REST API.","How to authenticate API requests"]}],[{"l":"Administration"},{"l":"Admin role","p":["The very first account created is automatically set up as an administrator account. Administrators have access to a dedicated area where they can manage global application settings as well as the user base. Click on the Admin link in the 2FAuth footer to access it."]},{"l":"Granted permissions","p":["Administrators can consult, create, promote, manage or delete any user account.","The account details visible to an administrator include:","The username","The email address","The user ID","The number of Personal Access Tokens","The number of WebAuthn security devices","The user preferences","The time the user registered and last visited","When the user registered using SSO:","The SSO provider","The user's ID on the provider side","Although administrators can view information on users, they cannot generate OTPs or even view users's 2FA."]},{"l":"Promote to administrator","p":["Any user may be promoted to administrator by another administrator. Edit the user account at Admin > Users > [User] > and check the flag. The change is effective immediately, without notification to the promoted user. Demoting is done the same way.","There must always be at least one administrator. The last administrator account cannot demoted.","An administrator account is identified as such by a banner in the Settings > Account section.","The administrator banner"]},{"l":"Application setup","p":["In addition to environment information, the Admin > App Setup page provides administrators with a number of features for managing the instance."]},{"l":"Version checking","p":["2FAuth can automatically check if a new version has been released. When enabled, a request will be made to GitHub every week to retrieve the latest version number. You can also run the check manually by clicking the button.","A new available version is reported to the administrators in the 2FAuth footer and the App Setup page.","The new version indicator in the 2FAuth footer","The new version alert in the App Setup page","This feature makes outgoing requests that you may want to pass through a proxy.","If so, set the PROXY_FOR_OUTGOING_REQUESTS environment variable."]},{"l":"Email testing","p":["2FAuth requires a valid email configuration to send emails to users. Features like password reset will not work otherwise.","Click the button to send a test email. The email will be sent to your registered email address.","2FAuth does not report whether a test email was successfully sent or not.","Check your email inbox first. If the email is not received, check your logs to get information on the issue."]},{"l":"Security","p":["See Data protection."]},{"l":"Authentication"},{"l":"Single Sign-On","p":["See SSO."]},{"l":"Registration control","p":["It is possible to restrict user registration to a limited range of email addresses or to completly disable registrations."]},{"l":"Restriction","p":["This is an authorization pattern, only email addresses that meet a condition are allowed to register.","Once the setting is enabled in Admin > App Setup, there are 2 ways to define the registration policy:","Email addresses from this list are allowed to register on 2FAuth.","Separate the addresses with a |. All must be valid email addresses. Ex: john@example.org|jane@example.net","Leave the field blank to disable the filter.","Email addresses that match a regular expression are allowed to register on 2FAuth.","For example, here is the regex to allow registering using any @example.org email address :","^[A-Za-z0-9._%+-]+@example\\.org","Both filtering options can be used simultaneously. The OR operator is applied, this means that the address only has to match one of the conditions to be allowed.","The registration policy does not affect SSO."]},{"l":"No registration","p":["Check the setting to fully disable registration. This affects SSO, so new users won't be able to sign in via SSO.","Check the setting to override this behavior. New users will be able to sign in for the first time using SSO whereas registration is disabled."]},{"l":"Users management"},{"l":"User creation","p":["Administrators can create new user account. Go to Admin > Users and click the button.","The form provides the exact same fields that a visitor would see in the registration form, with the same validation rules. An additional checkbox is available to directly grant administrator rights to the newly created user:","When an administrator creates a new user, the password is known. It could be considered a bad practice, but this gives some flexibility to the administrator to manage its user base the way he wants.","The administrator can always reset the password of the newly created user. See Access reset below."]},{"l":"Access reset","p":["While users have the ability to manage their access themselves, administrators can also take action to reset user access at Admin > Users > [User] >.","Possible actions:","Force resets the current user password with a randomly generated new password then sends a password reset email to the user so they can set their own password.","Using this, you are guaranteed that the user password has been changed. However, the user is free to set a custom password or not. The token bound to the password reset email received by the user has an expiry time of 60 minutes.","Any previous request for a password reset, from the user or an administrator, will be revoked.","Sends a new password reset email to the user without modifying their current password.","This generates a new reset token with an expiry time of 60 minutes, any previous request will be revoked.","Revokes all of the user's Personal Access Tokens.","Once their PATs have been revoked, the user will no longer be able to authenticate to the 2FAuth API.","This action is irreversible. Revoked tokens are not searchable, cannot be recovered, and cannot be deleted from the 2FAuth pages.","If for some reason you need to purge revoked (or expired) tokens, run the following Artisan commands:","Revokes all of the user's WebAuthn security devices.","Once their security devices have been revoked, the user will no longer be able to authenticate using WebAuthn.","If the user has checked the option at Settings > WebAuthn, revoking their security devices will reset the option so they can log in with their username and password.","This action is irreversible. Revoked devices are not searchable and cannot be recovered from the 2FAuth pages."]},{"l":"User deletion","p":["A user account can be deleted by an administrator, even an account with the Admin role. All data associated with the deleted account will also be deleted, including 2FA records, preferences, access tokens and logs.","Click the button at Admin > Users > [User] > to perform the delete.","This is not a soft delete. Deleted account cannot be recovered.","There must always be at least one administrator. The last administrator account cannot be deleted."]},{"l":"Health check","p":["2FAuth provides a special URL to check its health: /up","This is a very lightweight resource that responds with a 200 HTTP status code when the application is up and running. It can be used to set up a Docker HEALTHCHECK or a Kubernetes HTTPS liveness probe."]}],[{"l":"2FA Migration","p":["2FAuth can import data in various formats to ease you migrate from another 2FA app or to restore a backup. Note that not all 2FA apps enable data export so 2FAuth will never covers all possible migrations."]},{"l":"Exporting From","p":["First step is to export data from the 2FA source app in order to get a migration resource, like a file or a QR code. Follow one of the dedicated section below then jump to the Importing into 2FAuth step."]},{"l":"Google Authenticator","p":["Open Google Authenticator and use the icon to enter the Export feature.","Start the export feature","Next choose one or more accounts to export then click the button.","Export selected accounts","Google Authenticator now displays a QR code to import into 2FAuth. Keep it on screen or save a screen capture for later use or backup.","Exported QR code","If you choose to export more than 10 2FA accounts, Google Authenticator will generate several QR codes (one by tens).","The Import into 2FAuth process should be executed for each G-Auth QR code."]},{"l":"2FAS Authenticator","p":["Open 2FAS Authenticator and enter the Settings section. Then enter the 2FAS Backup feature.","2FAS Settings","Enter the Export tool.","2FAS Backup","Uncheck the password option and click the button.","2FAS Export","Save (and secure) the .2fas migration file, you are ready to import your accounts into 2FAuth"]},{"l":"Aegis Authenticator","p":["Open Aegis Authenticator and use the icon to enter the Settings section.","Aegis","Enter the Import & Export feature.","Aegis Settings","Open the Export tool.","Aegis Import Export","Whatever the export format (both are supported by 2FAuth), uncheck the encryption option and click the button.","Aegis Export","Save (and secure) the migration file, you are ready to import your accounts into 2FAuth"]},{"l":"Importing into 2FAuth","p":["The import process consists of 2 steps: The preloading (with validation) of the exported data and the recording of all or part of the valid data."]},{"l":"Preloading","p":["From the 2FAuth main view:","Click the button, just as if you had to add a new account","Click the button in the alternative methods","Submit your migration resource: a QR code or a file/QR code","2FAuth now lists all accounts found in the migration resource.","Preloaded data ready to be recorded","2FAuth checks for possible duplicates by comparing preloaded accounts with existing accounts in its database. Duplicates are simply flagged, they can still be imported.","Accounts that do not respect OTP specification are automatically skipped"]},{"l":"Recording","p":["This final step lets you save the preloaded accounts to the 2FAuth database.","You are free to record or discard the accounts of your choice.","Click on account titles to get a fresh OTP if you want to check the integrity of any account.","Nothing is added to 2FAuth until you click on an button or the button.","5 accounts registered, 3 remaining"]},{"l":"Exporting from 2FAuth","p":["2FAuth lets you export your 2FA data. This is particulary usefull when you want to create a backup on the fly or to migrate to another 2FA app."]},{"l":"Selective export","p":["From the main view of 2FAuth, click the button to switch to Edit mode. You will then be able to select the 2FA accounts that you want to export. Use the button of the view toolbar to select all of them in a click.","Once your selection is done, click the button. You will be prompt to download a migration file in JSON format.","2FAuth supports importing its own migration resource. See Importing into 2FAuth"]},{"l":"Export schema","p":["2FAuth uses its own JSON schema to structure the exported data."]}],[{"l":"Steam Guard","p":["Steam Guard is the Two-Factor authentication system you can enable to protect your Steam account. It works exactly as any 2FA protection, except that the One-Time Passwords are generated by the Steam Guard Mobile Authenticator only (or received by e-mail).","As Steam does not provide a standard way to use an alternative OTP app like 2FAuth, the workaround is to get the OTP secret thanks to a third-party app. Once recovered, you will be able to use 2FAuth in place of the Steam Mobile Authenticator.","This guide assumes you are a Steam user with some advanced skills who may already be using one of the following third-party apps. Installation and registration processes of the third-party apps are not described here, please refer to their respective documentation.","The secret is a sensitive data. Don't share it with anyone, don't save it anywhere without any protection."]},{"l":"Getting the Steam secret"},{"l":"Steam Desktop Authenticator (SDA)","p":["If your SDA data are encrypted, you need to (temporarily) disable encryption in order to read the secret:","Get the secret:","Open your SDA installation directory","In the ./maFiles subdirectory, open the file *.maFile","The secret is the string surrounded by secret= and issuer=Steam in the uri field value"]},{"l":"How to disable encryption in SDA","p":["Click the button of SDA","Type the current password","Submit the following 2 forms empty","Encryption if now Off"]},{"l":"Example","p":["In the following fake .maFile, the secret is D5RTFGT8Z7SW4DYU6I9UH5F4RRE1DF4G","Don't forget to set SDA encryption back On","Steam Desktop Authenticator"]},{"l":"steamguard-cli","p":["Open your steamguard-cli config directory, usually ~/.config/steamguard-cli/","In the ./maFiles subdirectory, open the file *.maFile","The secret is the string surrounded by secret= and issuer=Steam in the uri field value"]},{"l":"Adding to 2FAuth"},{"l":"The manual way","p":["Now that you got your steam secret, simply create a new account in 2FAuth using the advanced form:","Click the button","Fill the form:","Fill in the Account field","Fill in the Secret field with your Steam secret","Click the button to save the account","New Steam account using the advanced form"]},{"l":"QR code also works","p":["If you feel more confortable with QR codes, you can generate a QR code from the entire uri field of the *.maFile:","Then flash (or upload) the QR code to add the account to 2FAuth, just like any other QR code.","As said earlier, the secret is a sensitive data. You should definitely avoid online generators to convert such data."]}],[{"l":"API","p":["2FAuth is built on top of its own REST API (following OpenAPI 3.1 specification), which can be used to make any other app communicate with 2FAuth.","Description","groups","icons","Images used to illustrate 2FA accounts in 2FAuth","one-time password","preferences","qrcode","Resource","settings","The 2FA accounts stored in 2FAuth which you need to generate One-Time Passwords (OTP)","The 2FAuth administrator settings, which can be extended with custom settings","The API provides endpoints to manage most of the 2FAuth resources:","The groups used to organize 2FA accounts in 2FAuth","The One-Time Passwords (TOTP or HOTP) generated on demand","The user preferences","Two-dimensional barcode used to encode/share 2FA accounts","twofaccounts"]},{"l":"Authentication","p":["You authenticate in the 2FAuth API with a Personal Access Token(PAT) built upon the OAUTH Bearer authentication scheme (see RFC 6750). That means the PAT has to be passed via the HTTP Authorization header in every request made to the API.","A PAT is valid until you decide to revoke it."]},{"l":"Creating an access token","p":["Open the 2FAuth Settings > OAUTH section and click the link to generate a new token.","A PAT (in green) right after its creation","The token will only be shown once, right after its creation, so copy it immediately because you won't be able to display it again."]},{"l":"Revoking a token","p":["You can revoke a personal access token by simply clicking its button in the Settings > OAUTH section. A request made with a revoked token will receive a 401 Unauthorized response.","The revocation of a token is permanent and cannot be undone."]},{"l":"API documentation","p":["The API has its own dedicated documentation that you can browse in a lightweight format below. You may also use the fullscreen format which provides previous versions, a more comfortable layout and modern features like advanced search, mocking and more:","Fullscreen documentation"]}],[{"l":"Contributing","p":["2FAuth is an Open Source project, that means everybody can participate, in many differents ways. If Open Source is new to you, the following guide should be a good starting point:","How to Contribute to Open Source"]},{"l":"Enhancement & Feature suggestion","p":["Feel free to request some enhancements or new features. Not every request will be accepted but it can always be discussed.","Also please have a look to the 2FAuth development project, maybe your idea is already there.","2FAuth Backlog project on GitHub","2FAuth discussion on GitHub"]},{"l":"Development","p":["2FAuth is made with the following technologies:","PHP","Javascript","HTML/CSS","SQL* databases","If you are confortable with one of this language you are very welcome to submit some additions, modifications or fixes to the code base via a Pull Request on GitHub.","Please fork and push your changes to the 2FAuth dev branch"]},{"l":"Translation","p":["2FAuth is localized in several languages. You can contribute by correcting or completing translations in a language you speak, using the Crowdin platform.","Ask for your language if this does not yet exist.","2FAuth translations in Crowdin"]}],[{"l":"Bug reporting","p":["Found a bug? A report from you would be greatly appreciated!"]},{"l":"GitHub issues","p":["The preferred way to report a bug is to open an issue on GitHub.","GitHub eases the creation of issues by providing a template which encourage you to give as much information as possible on what's going on and the technical context.","Check the existing issues before creating a new one, maybe your issue has already been reported.","2FAuth issues on GitHub"]},{"l":"Contact","p":["You can also report your issue:","By email - contact 2fauth.app","On Twitter - @TwoFAuth","On Mastodon - @2FAuth@fosstodon"]}],[{"l":"Credits"},{"l":"Contributions","p":["2FAuth is actively developed by Bubka.","The Docker installation guide as well as the Docker stuff are a contribution of Quentin McGow."]},{"l":"Tools"},{"l":"Frameworks","p":["Laravel","Vue.js","Bulma CSS"]},{"l":"Graphics","p":["Font Awesome icon library"]},{"l":"Main dependencies"},{"l":"Composer","p":["Spomky-Labs/otphp","chillerlan/php-qrcode","khanamiryan/php-qrcode-detector-decoder"]},{"l":"npm","p":["gruhn/vue-qrcode-reader","vue-notification","vue-i18n","axios","Vue.Draggable"]},{"l":"css","p":["Wikiki/bulma-checkradio"]},{"l":"Docs generators","p":["Retype","RapiDoc"]}]]